function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function t(t,o){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,o){if(t){if("string"==typeof t)return e(t,o);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,o):void 0}}(t))||o&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=/*#__PURE__*/function(){function e(){}return e.encode=function(e){return window.btoa(e)},e.decode=function(e){return window.atob(e)},e.isHTML=function(e){var t=RegExp.prototype.test.bind(/(<([^>]+)>)/i);return e.match(t)},e.wrapString=function(e,t){return this.isHTML(e)?e:"<"+t+">"+e+"</"+t+">"},e.deepEqual=function(e,t){var o=this,n=Object.keys,i=typeof e;return e&&t&&"object"===i&&i===typeof t?n(e).length===n(t).length&&n(e).every(function(n){return o.deepEqual(e[n],t[n])}):e===t},e.compareObjects=function(e,t){var o=function e(t){return Object.entries(t).sort().map(function(t){return t[1]instanceof Object&&(t[1]=e(t[1])),t})};return JSON.stringify(o(e))===JSON.stringify(o(t))},e.objectEquals=function(e,t){var o=function(e){var t={};return JSON.stringify(e,function(e,o){return t[e]=null,o}),JSON.stringify(e,Object.keys(t).sort())};return o(e)===o(t)},e.prepareObjectsForComparison=function(e,t){var o=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(t));return o.forEach(function(e){e.checked=!0}),n.forEach(function(e){e.checked=!0}),{A:o,B:n}},e.mergeRecursively=function(e,t){for(var o in t)try{e[o]=t[o].constructor==Object?this.mergeRecursively(e[o],t[o]):t[o]}catch(n){e[o]=t[o]}return e},e}(),n=/*#__PURE__*/function(){function e(e,t){this.options=void 0,this.banner=void 0,this.cookiesManager=void 0,this.cookiesManager=e,this.options=t,e.getOptions().bannerOptions.inject&&this.injectBanner(),e.getOptions().bannerOptions.injectWall&&this.injectWall(),this.setEventListeners()}var t=e.prototype;return t.setEventListeners=function(){try{var e=this,t=document.querySelector(".cm-banner-accept-all-btn");t&&t.addEventListener("click",function(){e.cookiesManager.acceptAllButton(),e.options.acceptAllButton.onClick()});var o=document.querySelector(".cm-banner-reject-all-btn");o&&o.addEventListener("click",function(){e.cookiesManager.acceptAllButton(!1),e.options.rejectAllButton.onClick()});var n=document.querySelector(".cm-banner-config-btn");n&&n.addEventListener("click",function(){e.cookiesManager.showModal(),e.options.settingsButton.onClick()})}catch(e){console.error("Can't set the event listener for the cookies banner. Can't find the HTML elements.")}},t.generateBanner=function(){return'\n                <div class="c-cookies-config-banner">\n                    <div class="banner-container">\n                        '+this.getBannerText()+'\n                        <div class="banner-container__buttons">\n                            '+this.getRejectAllButton()+"\n                            "+this.getAcceptAllButton()+"\n                            "+this.getSettingsButton()+"\n                        </div>\n                    </div>\n                </div> \n                "},t.getAcceptAllButton=function(){return this.options.acceptAllButton.show?'<button class="banner-container__button banner-container__accept-all-btn cm-banner-accept-all-btn">'+this.options.acceptAllButton.text+"</button>":""},t.getRejectAllButton=function(){return this.options.rejectAllButton.show?'<button class="banner-container__button banner-container__reject-all-btn cm-banner-reject-all-btn">'+this.options.rejectAllButton.text+"</button>":""},t.getSettingsButton=function(){return this.options.settingsButton.show?'<button class="banner-container__button-link banner-container__config-btn cm-banner-config-btn">'+this.options.settingsButton.text+"</button>":""},t.getBannerText=function(){return o.wrapString(this.options.bannerText,"p")},t.injectWall=function(){try{null!=document.querySelector("body")&&document.querySelector("body").insertAdjacentHTML("afterend",this.generateWall())}catch(e){console.error("Couldn't inject the wall.")}},t.injectBanner=function(){try{null!=document.querySelector("body")&&document.querySelector("body").insertAdjacentHTML("afterend",this.generateBanner())}catch(e){console.error("Couldn't inject the banner.")}},t.generateWall=function(){return'<div class="c-cookies-config-wall '+(this.options.wallBlur?"c-cookies-config-wall--blurred":"")+'"></div>'},t.showWall=function(){try{document.querySelector(".c-cookies-config-wall").classList.add("wall-show")}catch(e){console.error("Couldn't apply the background wall.")}},t.hideWall=function(){try{document.querySelector(".c-cookies-config-wall").classList.remove("wall-show")}catch(e){console.error("Unable to hide the background wall.")}},t.hideScroll=function(){try{document.querySelector("body").style.overflow="hidden",document.querySelector("html").style.overflow="hidden"}catch(e){console.error("Unable to hide the scroll.")}},t.showScroll=function(){try{document.querySelector("body").style.overflow="auto",document.querySelector("html").style.overflow="auto"}catch(e){console.error("Unable to show the scroll.")}},t.show=function(){this.options.wall&&this.showWall(),this.options.wallScroll||this.hideScroll();try{document.querySelector(".c-cookies-config-banner .banner-container").classList.add("show-banner")}catch(e){console.error("Unable to show the banner.")}},t.hide=function(){try{document.querySelector(".c-cookies-config-banner").style.display="none"}catch(e){console.error("Unable to hide the banner.")}this.hideWall(),this.showScroll()},e}();function i(e,t,o){if(!e.s){if(o instanceof c){if(!o.s)return void(o.o=i.bind(null,e,t));1&t&&(t=o.s),o=o.v}if(o&&o.then)return void o.then(i.bind(null,e,t),i.bind(null,e,2));e.s=t,e.v=o;const n=e.o;n&&n(e)}}var c=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(t,o){var n=new e,c=this.s;if(c){var r=1&c?t:o;if(r){try{i(n,1,r(this.v))}catch(e){i(n,2,e)}return n}return this}return this.o=function(e){try{var c=e.v;1&e.s?i(n,1,t?t(c):c):o?i(n,1,o(c)):i(n,2,c)}catch(e){i(n,2,e)}},n},e}();function r(e){return e instanceof c&&1&e.s}var s,a=/*#__PURE__*/function(){function e(e,t){this.options=void 0,this.cookiesManager=void 0,this.cookiesManager=e,this.options=t,e.getOptions().modalOptions.inject&&this.injectModal(),this.setEventListeners(),this.updateSwitchesStatus()}var t=e.prototype;return t.show=function(){try{var e=this;return Promise.resolve(function(t,o){try{var n=(document.querySelector(".c-cookies-config-modal").classList.add(e.options.showModalClass),Promise.resolve(new Promise(function(e){return setTimeout(e,10)})).then(function(){function t(){document.getElementById("modal-container").classList.add(e.options.showModalClass),e.cookiesManager.getBanner().hideScroll()}var o,n=document.getElementsByClassName("cm-accordion"),s=e;o=0;var a=function(e,t,o){for(var n;;){var s=e();if(r(s)&&(s=s.v),!s)return a;if(s.then){n=0;break}var a=o();if(a&&a.then){if(!r(a)){n=1;break}a=a.s}if(t){var l=t();if(l&&l.then&&!r(l)){n=2;break}}}var u=new c,d=i.bind(null,u,2);return(0===n?s.then(f):1===n?a.then(h):l.then(g)).then(void 0,d),u;function h(n){a=n;do{if(t&&(l=t())&&l.then&&!r(l))return void l.then(g).then(void 0,d);if(!(s=e())||r(s)&&!s.v)return void i(u,1,a);if(s.then)return void s.then(f).then(void 0,d);r(a=o())&&(a=a.v)}while(!a||!a.then);a.then(h).then(void 0,d)}function f(e){e?(a=o())&&a.then?a.then(h).then(void 0,d):h(a):i(u,1,a)}function g(){(s=e())?s.then?s.then(f).then(void 0,d):f(s):i(u,1,a)}}(function(){return o<n.length},function(){return o++},function(){var e=function(){if(n[o].classList.contains("cm-active-on-load"))return n[o].classList.remove("cm-active-on-load"),Promise.resolve(new Promise(function(e){return setTimeout(e,100)})).then(function(){s.toggleAccordion(n[o])})}();if(e&&e.then)return e.then(function(){})});return a&&a.then?a.then(t):t()}))}catch(e){return o(e)}return n&&n.then?n.then(void 0,o):n}(0,function(e){console.error("Could not show cookie modal."),console.error(e)}))}catch(e){return Promise.reject(e)}},t.hide=function(e){document.getElementById("modal-container").classList.remove(this.options.showModalClass);var t=document.querySelector(".c-cookies-config-banner .banner-container");(0==(null==t?void 0:t.classList.contains("show-banner"))||this.cookiesManager.getOptions().bannerOptions.wallScroll)&&this.cookiesManager.getBanner().showScroll()},t.setEventListeners=function(){var e=this;try{var t=this;document.querySelectorAll(".close-modal").forEach(function(o){return o.addEventListener("click",function(){e.hide(t)})});var o=document.querySelector(".cm-modal-accept-all");o&&o.addEventListener("click",function(){t.cookiesManager.acceptAllButton(),t.cookiesManager.getOptions().modalOptions.acceptAllButton.onClick()});var n=document.querySelector(".cm-modal-reject-all");n&&n.addEventListener("click",function(){t.cookiesManager.acceptAllButton(!1),t.cookiesManager.getOptions().modalOptions.rejectAllButton.onClick()});var i=document.querySelector(".cm-modal-save");i&&i.addEventListener("click",function(){t.cookiesManager.injectScripts(),t.cookiesManager.hideBanner(),t.cookiesManager.saveButton(),t.cookiesManager.getOptions().modalOptions.saveButton.onClick()}),this.cookiesManager.getOptions().cookieCategories.forEach(function(e,o){var n=document.querySelector(".cm-switch-"+o);document.querySelectorAll(".c-cookies-config-modal .cookie-category"),n.addEventListener("change",function(){this.checked?(e.checked=!0,t.toggleSwitch(o,!0)):(e.checked=!1,t.toggleSwitch(o,!1))})});var c,r=document.getElementsByClassName("cm-accordion");for(t=this,c=0;c<r.length;c++)r[c].addEventListener("click",function(){t.toggleAccordion(this)})}catch(e){console.error("Could not set event listeners for cookie modal.")}},t.updateSwitchDisabledStatus=function(e,t){try{var o=document.querySelectorAll(".c-cookies-config-modal .cookie-category"),n=o[e].querySelector(".cm-switch-"+e),i=o[e].querySelector(".slider"),c=o[e].querySelector("label.switch");t?(n.setAttribute("disabled",""),i.classList.add("disabled"),c.classList.add("disabled")):(n.removeAttribute("disabled"),i.classList.remove("disabled"),c.classList.remove("disabled"))}catch(t){console.error("Could not change the disabled status from switch cm-switch-"+e+". Do you have equal switches and cookieCategories? If cm-switch-"+e+" does not exist in your DOM, probably not.")}},t.toggleSwitch=function(e,t){try{var o=document.querySelectorAll(".c-cookies-config-modal .cookie-category")[e].querySelector(".cm-switch-"+e);t?o.setAttribute("checked",""):o.removeAttribute("checked"),o.checked=t}catch(t){console.error("Could not toggle the switch cm-switch-"+e+". Do you have equal switches and cookieCategories? If cm-switch-"+e+" does not exist in your DOM, probably not.")}},t.toggleAccordion=function(e){try{e.classList.toggle("cm-active");var t=e.nextElementSibling;return t.style.maxHeight=t.style.maxHeight?null:t.scrollHeight+"px",Promise.resolve()}catch(e){return Promise.reject(e)}},t.injectModal=function(){try{null!=document.querySelector("body")&&document.querySelector("body").insertAdjacentHTML("afterend",this.generateModal())}catch(e){console.error("Could not inject cookie modal.")}},t.updateSwitchesStatus=function(){var e=this;this.cookiesManager.getOptions().cookieCategories.forEach(function(t,o){try{e.toggleSwitch(o,t.checked),e.updateSwitchDisabledStatus(o,t.required)}catch(e){console.error("You have more cookieCategories defined in javascript than in your HTML. Please, use the same number of cookieCategories.")}})},t.generateCategoriesBlocks=function(){var e="",t=this.cookiesManager.getOptions().cookieCategories;return null!=localStorage.getItem("cookiesManagerOptions")&&(t=this.cookiesManager.getCookiesOptions()),t.forEach(function(t,o){var n=t.required?"disabled":"";e+='\n            <div class="cookie-category">\n                <div class="cookie-category__header cc-header '+(t.accordion.enable?"cm-accordion":"")+" "+(t.boxedHeader?"cm-boxed":"")+" "+(t.accordion.active?"cm-active-on-load":"")+'">\n                    '+(t.accordion.enable?"<div class='cc-header__left'></div>":"")+'\n                    <div class="cc-header__right">\n                        <div class="header__title">\n                            '+t.title+'\n                        </div>\n                        <div class="header__switch">\n                            <label class="switch '+n+'">\n                                <input '+n+" "+(t.checked?"checked":"")+' class="cm-switch-'+o+'" type="checkbox">\n                                <span class="slider round '+n+'"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n                <div class="cookie-category__body body '+(t.boxedBody?"cookie-category__body--boxed":"")+" "+(t.accordion.enable?"cm-panel":"")+'">\n                    <p>'+t.description+"</p>\n                </div>\n            </div>\n            "}),e},t.getCloseButton=function(){return this.options.closeButton.show?'<div class="modal__close close-modal" title="Close"><div class="close-modal-img"></div></div>':""},t.getAcceptAllButton=function(){return this.options.acceptAllButton.show?'<button class="modal__button modal__button-width cm-modal-accept-all footer__button-accept-all">'+this.options.acceptAllButton.text+"</button>":""},t.getRejectAllButton=function(){return this.options.rejectAllButton.show?'<button class="modal__button modal__button-width cm-modal-reject-all footer__button-reject-all">'+this.options.rejectAllButton.text+"</button>":""},t.getSaveButton=function(){return this.options.saveButton.show?' <button class="modal__button-link close-modal cm-modal-save footer__button-save-btn"> '+this.options.saveButton.text+" </button>":""},t.generateModal=function(){return'\n        <div class="c-cookies-config-modal">\n        <div class="modal__container" id="modal-container">\n          <div class="modal__content">\n            '+this.getCloseButton()+'\n            <div class="modal__title">'+this.options.title+'</div>\n            <p class="modal__description">'+this.options.description+'</p>\n            <div class="modal__cookie-categories">\n                '+this.generateCategoriesBlocks()+'\n            </div>\n    \n            <div class="modal__footer">\n             '+this.getRejectAllButton()+"\n             "+this.getAcceptAllButton()+"\n             "+this.getSaveButton()+"\n            </div>\n          </div>\n        </div>\n      </div>\n        "},e}(),l=/*#__PURE__*/function(){var e=i.prototype;function i(e){var t=this;if(this.modalOptions=void 0,this.banner=void 0,this.modal=void 0,this.acceptAll=!1,this.configChanged=!1,this.onCookieCategoryChange=void 0,null==e)throw new Error("Options for CookiesManager cannot be null.");if(null==e.cookieCategories)throw new Error("You should provide at least one cookie category");var n=new Array;e.cookieCategories.forEach(function(e){n.push(o.mergeRecursively(t.getDefaultCookieCategoryOptions(),e))}),e.cookieCategories=n;var i=e.cookieCategories;e=o.mergeRecursively(this.getDefaultOptions(),e),this.modalOptions=e,this.constructorInitializationFunction(e,i)}return e.getBanner=function(){return this.banner},e.setBanner=function(e){this.banner=e},e.getModal=function(){return this.modal},e.setModal=function(e){this.modal=e},e.getOptions=function(){return this.modalOptions},e.on=function(e,t){"onCookieCategoryChange"==e&&(this.onCookieCategoryChange=t)},e.constructorInitializationFunction=function(e,t){if(null!=localStorage.getItem("cookiesManagerOptions")){var n=o.prepareObjectsForComparison(this.modalOptions.cookieCategories,this.getCookiesOptions());o.objectEquals(n.A,n.B)?(this.modalOptions.cookieCategories=this.getCookiesOptions(),this.modalOptions.cookieCategories.forEach(function(e,o){e.events=t[o].events})):(localStorage.removeItem("cookiesManagerOptions"),this.configChanged=!0)}null!=e.modalOptions&&this.createModal(e.modalOptions),null!=e.bannerOptions&&this.createBanner(e.bannerOptions)},e.setEventListeners=function(){this.modal.setEventListeners(),this.banner.setEventListeners()},e.createBanner=function(e){return this.banner=new n(this,e),this.banner},e.createModal=function(e){return this.modal=new a(this,e),this.modal},e.setCookies=function(){var e=this;this.modalOptions.cookieCategories.forEach(function(t){t.events.setCookiesOnChange.forEach(function(o){var n;t.checked?e.setCookie(o.cookieName,n=o.valueOnAccept,o.expirationDays,"/"):(n=o.valueOnReject,-1!=e.getOptions().askAgainIfRejectedAfterDays?e.setCookie(o.cookieName,n,e.getOptions().askAgainIfRejectedAfterDays,"/"):e.setCookie(o.cookieName,n,o.expirationDays,"/"))})})},e.setCookie=function(e,t,o,n){void 0===o&&(o=400),void 0===n&&(n="/");try{document.cookie=e+"="+encodeURIComponent(t)+"; max-age="+24*o*3600+"; path="+n}catch(e){console.error("Error setting cookie: "+e)}},e.getCookie=function(e){var t={};return document.cookie.split(";").forEach(function(e){var o=e.split("="),n=o[1];t[o[0].trim()]=n}),t[e]},e.acceptAllButton=function(e){void 0===e&&(e=!0),this.getOptions().cookieCategories.forEach(function(t){t.checked=!(!t.required||0!=e)||e}),this.modal.updateSwitchesStatus(),this.acceptAll=!0,this.modal.hide(),this.banner.hide(),this.injectScripts(),this.saveCookieOptions(),this.setCookies(),this.callIndividualCallbacks()},e.showModal=function(){this.modal.show()},e.showBanner=function(){this.banner.show()},e.hideBanner=function(){this.banner.hide()},e.hideModal=function(){this.modal.hide()},e.callIndividualCallbacks=function(){var e=this;this.modalOptions.cookieCategories.forEach(function(t){t.checked||e.acceptAll?t.events.onAccept():t.checked||t.events.onReject()})},e.injectScript=function(e,t){void 0===t&&(t=!1);var o=document.createElement("script");o.setAttribute("src",e),o.async=t,document.body.appendChild(o)},e.injectGTM=function(e){try{!function(e,t,o,n,i){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var c=t.getElementsByTagName(o)[0],r=t.createElement(o);r.src="https://www.googletagmanager.com/gtm.js?id="+i,c.parentNode.insertBefore(r,c)}(window,document,"script","dataLayer",e),window.dataLayer=window.dataLayer||[]}catch(e){console.error("Couldn't inject GTM.")}},e.init=function(e,o){try{var n=function(){null!=localStorage.getItem("cookiesManagerOptions")&&(i.injectScripts(),i.callIndividualCallbacks())},i=this,c=function(){if(!i.modalOptions.askOnce)return Promise.resolve(i.initShow(e,o)).then(function(){});var n=function(){if(null==localStorage.getItem("cookiesManagerOptions")||i.configChanged)return Promise.resolve(i.initShow(e,o)).then(function(){});for(var n,c=!1,r=i.getCookiesOptions(),s=t(i.modalOptions.cookieCategories.entries());!(n=s()).done;){var a=n.value,l=a[0],u=a[1];if(c)break;for(var d,h=t(u.events.setCookiesOnChange.entries());!(d=h()).done;){var f=d.value,g=f[0],v=f[1];if(!i.getCookie(v.cookieName)){i.initShow(e,o),c=!0;break}if(![v.valueOnAccept.toString(),v.valueOnReject.toString()].includes(i.getCookie(v.cookieName))){i.initShow(e,o),c=!0;break}if(u.checked){var m=r[l].events.setCookiesOnChange[g].valueOnAccept,p=i.getCookie(r[l].events.setCookiesOnChange[g].cookieName);if(m.toString()!=p){i.initShow(e,o);break}}}}}();return n&&n.then?n.then(function(){}):void 0}();return Promise.resolve(c&&c.then?c.then(n):n())}catch(e){return Promise.reject(e)}},e.initShow=function(e,t){try{var o=function(){e&&n.showBanner(),t&&n.showModal()},n=this,i=function(){if(n.modalOptions.delay>0)return Promise.resolve(new Promise(function(e){return setTimeout(e,n.modalOptions.delay)})).then(function(){})}();return Promise.resolve(i&&i.then?i.then(o):o())}catch(e){return Promise.reject(e)}},e.injectScripts=function(){var e=this;try{this.modalOptions.cookieCategories.forEach(function(t){null!=e.onCookieCategoryChange&&e.onCookieCategoryChange(t),(t.checked||e.acceptAll)&&t.scripts.forEach(function(t){if(t.type==s.STANDARD||null==t.type)null!=t.scriptSrc&&e.injectScript(t.scriptSrc,t.async);else{if(null==t.gtmCode)throw new Error("You should provide a gtmCode for the script");e.injectGTM(t.gtmCode)}})})}catch(e){console.error("Couldn't inject scripts: "+e)}},e.saveButton=function(){this.saveCookieOptions(),this.setCookies(),this.callIndividualCallbacks()},e.saveCookieOptions=function(){var e=o.encode(JSON.stringify(this.modalOptions.cookieCategories));localStorage.setItem("cookiesManagerOptions",e)},e.getCookiesOptions=function(){return null!=localStorage.getItem("cookiesManagerOptions")?JSON.parse(o.decode(localStorage.getItem("cookiesManagerOptions"))):{}},e.getDefaultCookieCategoryOptions=function(){return{title:"Cookie Category Example",description:"Cookie category description",required:!1,id:"",checked:!0,events:{onAccept:function(){},onReject:function(){},setCookiesOnChange:[]},accordion:{enable:!1,enableOnDescriptionLength:45,active:!1},boxedHeader:!1,boxedBody:!1,scripts:[]}},e.getDefaultOptions=function(){return{askOnce:!0,askAgainIfRejectedAfterDays:-1,delay:0,askOnChange:!0,initOnDomContentLoaded:!0,modalOptions:{title:"Cookie settings",description:"Change the settings for the cookies here.",inject:!0,showModalClass:"show-modal",acceptAllButton:{text:"Accept all",show:!0,onClick:function(){}},rejectAllButton:{text:"Reject all",show:!0,onClick:function(){}},saveButton:{text:"Save",show:!0,onClick:function(){}},closeButton:{text:"Close",show:!0,onClick:function(){}}},bannerOptions:{inject:!0,injectWall:!0,wall:!0,wallScroll:!0,wallBlur:!1,bannerText:"This website uses cookies to ensure you get the best experience on our website.",acceptAllButton:{text:"Accept all",show:!0,onClick:function(){}},settingsButton:{text:"Settings",show:!0,onClick:function(){}},acceptRequiredOnlyButton:{text:"Configuración",show:!1,onClick:function(){}},rejectAllButton:{text:"Rechazar todo",show:!0,onClick:function(){}}},cookieCategories:[]}},i}();!function(e){e[e.GTM=0]="GTM",e[e.STANDARD=1]="STANDARD"}(s||(s={}));export{l as CookiesManager,s as ScriptType};
//# sourceMappingURL=index.esm.mjs.map
