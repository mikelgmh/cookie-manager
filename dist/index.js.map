{"version":3,"file":"index.js","sources":["../src/utils.ts","../src/CookiesManager.ts","../src/Banner.ts","../src/Modal.ts"],"sourcesContent":["\nexport class Utils {\n    public static encode(str) {\n        return window.btoa(str);\n    }\n    public static decode(a) {\n        return window.atob(a);\n    }\n    public static isHTML(str: string) {\n        var isHTML = RegExp.prototype.test.bind(/(<([^>]+)>)/i);\n\n        // test isHTML regex\n        return str.match(isHTML);\n\n    }\n    public static wrapString(str: string, tag: string) {\n        return `<${tag}>${str}</${tag}>`;\n    }\n\n    public static deepEqual(x, y) {\n        const ok = Object.keys, tx = typeof x, ty = typeof y;\n        return x && y && tx === 'object' && tx === ty ? (\n            ok(x).length === ok(y).length &&\n            ok(x).every(key => this.deepEqual(x[key], y[key]))\n        ) : (x === y);\n    }\n\n    public static compareObjects(a, b) {\n        let s = (o) => Object.entries(o).sort().map(i => {\n            if (i[1] instanceof Object) i[1] = s(i[1]);\n            return i\n        })\n        return JSON.stringify(s(a)) === JSON.stringify(s(b))\n    }\n\n    public static objectEquals(obj1, obj2) {\n        const JSONstringifyOrder = obj => {\n            const keys = {};\n            JSON.stringify(obj, (key, value) => {\n                keys[key] = null;\n                return value;\n            });\n            return JSON.stringify(obj, Object.keys(keys).sort());\n        };\n        return JSONstringifyOrder(obj1) === JSONstringifyOrder(obj2);\n    }\n\n    public static prepareObjectsForComparison(obj1, obj2) {\n        var A = JSON.parse(JSON.stringify(obj1));\n        var B = JSON.parse(JSON.stringify(obj2));\n\n\n        A.forEach(element => {\n            element.checked = true;\n        });\n        B.forEach(element => {\n            element.checked = true;\n        });\n        return { A, B }\n    }\n\n    public static mergeRecursively(obj1, obj2) {\n        for (var p in obj2) {\n            try {\n                // Property in destination object set; update its value.\n                if (obj2[p].constructor == Object) {\n                    obj1[p] = this.mergeRecursively(obj1[p], obj2[p]);\n                } else {\n                    obj1[p] = obj2[p];\n                }\n            } catch (e) {\n                // Property in destination object not set; create it and set its value.\n                obj1[p] = obj2[p];\n            }\n        }\n        return obj1;\n    }\n}","\nimport { Banner, BannerOptions } from \"./Banner\";\nimport { ModalOptions, Modal } from './Modal';\nimport \"./scss/styles.scss\";\nimport { Utils } from './utils';\nexport class CookiesManager {\n\n    // var isHTML = RegExp.prototype.test.bind(/(<([^>]+)>)/i);\n    private modalOptions: Options;\n    private banner: Banner;\n    private modal: Modal;\n    private acceptAll: boolean = false;\n    private configChanged: boolean = false;\n\n\n    public getBanner(): Banner {\n        return this.banner;\n    }\n\n    public setBanner(banner: Banner): void {\n        this.banner = banner;\n    }\n\n    public getModal(): Modal {\n        return this.modal;\n    }\n\n    public setModal(modal: Modal): void {\n        this.modal = modal;\n    }\n\n    public getOptions(): Options {\n        return this.modalOptions;\n    }\n\n    constructor(options: Options) {\n        if (options == null) {\n            throw new Error(\"Options cannot be null\");\n        } else {\n            options.cookieCategories.forEach(category => {\n                category.checked = true;\n            });\n            // Merge the default options with user options\n            options = Utils.mergeRecursively(this.getDefaults(), options);\n            this.modalOptions = options;\n            // Check options to create banner and modal\n\n            if (localStorage.getItem(\"cookiesManagerOptions\") != null) {\n                // Prepare the options to compare them.\n                var optionsComparison = Utils.prepareObjectsForComparison(this.modalOptions.cookieCategories, this.getCookiesOptions());\n\n                // Check if the options in localStorage and the options from the constructor are the same\n                if (Utils.objectEquals(optionsComparison.A, optionsComparison.B)) {\n                    // If the options are the same, just inject the scripts\n                    this.modalOptions.cookieCategories = this.getCookiesOptions();\n                    this.injectScripts();\n                } else {\n                    // If the options are different, set the configChanged to true\n                    // We are in the constructor. By setting this to true, it might show the banner and modal if the user has set askOnChange to true\n                    this.configChanged = true;\n                }\n            }\n\n            // Generate modal\n            if (options.modalOptions != null) {\n                this.createModal(options.modalOptions);\n            }\n\n\n            if (options.bannerOptions != null) {\n                this.createBanner(options.bannerOptions);\n            }\n\n        }\n\n    }\n\n\n    public createBanner(options: BannerOptions) {\n        this.banner = new Banner(this, options);\n        return this.banner;\n    }\n    public createModal(options: ModalOptions) {\n        this.modal = new Modal(this, options);\n        return this.modal;\n    }\n\n    public acceptAllButton() {\n        this.acceptAll = true;\n        this.modal.hide();\n        this.banner.hide();\n        this.injectScripts();\n        //this.setCookie();\n        this.saveCookieOptions();\n    }\n\n    public showModal() {\n        this.modal.show();\n    }\n\n    public showBanner() {\n        this.banner.show();\n    }\n\n    public hideBanner() {\n        this.banner.hide();\n    }\n\n    public hideModal() {\n        this.modal.hide();\n    }\n\n    private injectScript(src: string, async) {\n        var s = document.createElement('script');\n        s.setAttribute('src', src);\n        s.async = async;\n        document.body.appendChild(s);\n    }\n\n    private injectGTM(gtmCode: string) {\n        try {\n            (function (w, d, s, l, i) {\n                w[l] = w[l] || [];\n                w[l].push({\n                    'gtm.start': new Date().getTime(),\n                    event: 'gtm.js',\n                });\n                const f = d.getElementsByTagName(s)[0];\n                const j = d.createElement(s) as HTMLInputElement;\n                const\n                    dl = l != 'dataLayer' ? `&l=${l}` : '';\n                //j.async = true;\n                j.src = `https://www.googletagmanager.com/gtm.js?id=${i}${dl}`;\n                f.parentNode!.insertBefore(j, f);\n            }(window, document, 'script', 'dataLayer', gtmCode));\n            (window as any).dataLayer = (window as any).dataLayer || [];\n        } catch (error) {\n            console.log(\"There was an error loading GTM.\")\n        }\n    }\n\n    public init(banner: boolean, modal: boolean) {\n        if (this.modalOptions.askOnce) {\n            // TODO ver casuística si askOnChange es false, configChanged es true, se inyectan los scripts? No se intectan si no se muestran los banners Debería haber un else?\n            if (localStorage.getItem(\"cookiesManagerOptions\") == null || (this.modalOptions.askOnChange && this.configChanged)) {\n                var bannerShown = false;\n                var modalShown = false;\n                if (banner) {\n                    this.showBanner();\n                    bannerShown = true;\n                }\n                if (modal) {\n                    this.showModal();\n                    modalShown = true;\n                }\n                // if(!bannerShown && !modalShown && this.configChanged == true && !this.modalOptions.askOnChange){\n                //     this.injectScripts();\n                // }\n            }\n        } else {\n            if (banner) {\n                this.showBanner();\n            }\n            if (modal) {\n                this.showModal();\n            }\n        }\n    }\n\n    public injectScripts() {\n        this.modalOptions.cookieCategories.forEach(category => {\n            if (category.checked || this.acceptAll) {\n                category.scripts.forEach(script => {\n                    if (script.type == ScriptType.STANDARD || script.type == null) {\n                        this.injectScript(script.scriptSrc, script.async)\n                    } else {\n                        this.injectGTM(script.gtmCode);\n                    }\n                });\n            }\n        });\n    }\n\n    saveButton() {\n        //this.setCookie();\n        this.saveCookieOptions();\n    }\n\n    saveCookieOptions() {\n        const base64Options = Utils.encode(JSON.stringify(this.modalOptions.cookieCategories));\n        localStorage.setItem(\"cookiesManagerOptions\", base64Options);\n    }\n\n    getCookiesOptions(): any {\n        return JSON.parse(Utils.decode(localStorage.getItem(\"cookiesManagerOptions\")));\n    }\n\n    private getDefaults(): Options {\n        return {\n            askOnce: true,\n            askOnChange: true,\n            modalOptions: {\n                acceptAllButton: {\n                    text: 'Accept all',\n                    show: true,\n                },\n                saveButton: {\n                    text: 'Settings',\n                    show: true,\n                },\n                closeButton: {\n                    text: 'Settings',\n                    show: true,\n                },\n            },\n            bannerOptions: {\n                wall: true,\n                wallScroll: false,\n                wallBlur: true,\n                bannerText: 'This website uses cookies to ensure you get the best experience on our website.',\n                acceptAllButton: {\n                    text: 'Accept all',\n                    show: true,\n                },\n                settingsButton: {\n                    text: 'Configuración',\n                    show: true,\n                },\n                acceptRequiredOnlyButton: {\n                    text: 'Configuración',\n                    show: false,\n                },\n                rejectAllButton: {\n                    text: 'Configuración',\n                    show: false,\n                }\n            },\n            cookieCategories: [],\n        }\n    }\n\n\n\n}\n\nexport interface Options {\n    cookieCategories: Array<CookieCategory>,\n    bannerOptions: BannerOptions,\n    modalOptions: ModalOptions,\n    askOnce: boolean,\n    askOnChange: boolean,\n}\n\nexport interface CookieCategory {\n    title: string,\n    description: string,\n    required: boolean,\n    checked: boolean,\n    scripts: [\n        {\n            type: ScriptType,\n            gtmCode: string,\n            scriptSrc: string,\n            async: boolean,\n        }\n    ]\n}\n\nexport enum ScriptType {\n    GTM,\n    STANDARD\n}","import { Modal } from \"./Modal\";\nimport { Utils } from './utils';\nimport { CookiesManager } from './CookiesManager';\n\nexport class Banner {\n    private options: BannerOptions;\n    private banner: string;\n    private cookiesManager: CookiesManager;\n\n    constructor(cookiesManager: CookiesManager, options: BannerOptions) {\n        this.cookiesManager = cookiesManager;\n        this.options = options;\n        this.injectBanner();\n        this.setEventListeners();\n    }\n\n    private setEventListeners() {\n        let self = this;\n        // Accept all button\n        document.querySelector(\".banner-container__accept-all-btn\")!.addEventListener(\"click\", function () {\n            self.cookiesManager.acceptAllButton();\n        });\n\n        // Config button\n        document.querySelector(\".banner-container__config-btn\")!.addEventListener(\"click\", function () {\n            //self.options.settingsButton.modal.show();\n            self.cookiesManager.showModal();\n        });\n\n    }\n\n\n\n\n    private generateBanner() {\n        return `\n                <div class=\"c-cookies-config-banner\">\n            <div class=\"banner-container\">\n            ${this.getBannerText()}\n            <div class=\"banner-container__buttons\">\n                <button class=\"banner-container__button banner-container__accept-all-btn\">${this.getAcceptAllButtonText()}</button>\n                <button class=\"banner-container__button-link banner-container__config-btn\">Configurar</button>\n            </div>\n            </div>\n        </div> \n        `;\n    }\n    private getBannerText() {\n\n        if (this.options.bannerText != undefined) {\n            if (Utils.isHTML(this.options.bannerText)) {\n                return this.options.bannerText;\n            }\n            // Else return wrapped\n            return Utils.wrapString(this.options.bannerText, \"p\");\n        }\n        return `\n                <p>Utilizamos cookies propias y de terceros para analizar el tráfico en nuestra web mediante la obtención de los\n                        datos necesarios para estudiar tu navegación. Puedes obtener más información en la Política de Cookies. Puedes\n                        aceptar todas las cookies pulsando el botón “Aceptar\" o configurarlas o rechazar su uso pulsando en\n                        \"Configurar\".</p>\n                `;\n    }\n    private getAcceptAllButtonText() {\n        if (this.options.acceptAllButton.text != undefined) {\n            // Else return wrapped\n            return this.options.acceptAllButton.text;\n        }\n        return `Aceptar todo`;\n    }\n\n    public injectBanner() {\n        if (document.querySelector(\"body\") != null) {\n\n            document.querySelector(\"body\")!.insertAdjacentHTML(\"afterend\", this.generateBanner());\n        }\n    }\n\n    public showWall() {\n        const blur = this.options.wallBlur ? \"c-cookies-config-wall--blurred\" : \"\";\n        const wall = `<div class=\"c-cookies-config-wall ${blur}\"></div>`;\n        document.querySelector(\"body\")!.insertAdjacentHTML(\"afterend\", wall);\n\n    }\n\n    public hideWall() {\n        const test = document.querySelector<HTMLElement>(\".c-cookies-config-wall\")!;\n        test.style.display = \"none\";\n    }\n\n    public hideScroll() {\n        document.querySelector(\"body\")!.style.overflow = \"hidden\";\n    }\n\n    public showScroll() {\n        document.querySelector(\"body\")!.style.overflow = \"auto\";\n    }\n\n    public show() {\n        //document.querySelector<HTMLElement>(\".c-cookies-config-banner\")!.style(\"display\", \"blockxº\");\n        if (this.options.wall) {\n            this.showWall();\n        }\n        if (!this.options.wallScroll) {\n            this.hideScroll();\n        }\n        const test = document.querySelector<HTMLElement>(\".c-cookies-config-banner .banner-container\")!;\n        test.classList.add(\"show-banner\");\n    }\n    public hide() {\n        const test = document.querySelector<HTMLElement>(\".c-cookies-config-banner\")!;\n        test.style.display = \"none\";\n        this.hideWall();\n        this.showScroll();\n        // document.querySelector(\".c-cookies-config-banner\")!.style(\"display\", \"none\");\n        // Array.from(document.querySelector(\".c-cookies-config-banner\") as unknown as HTMLCollectionOf<HTMLElement>);\n    }\n}\n\n\n\n\nexport interface BannerOptions {\n    bannerText: string;\n    wall: boolean,\n    wallScroll: boolean,\n    wallBlur: boolean,\n    acceptAllButton: {\n        text: string,\n        show: boolean,\n    },\n    settingsButton: {\n        text: string,\n        show: boolean,\n    },\n    acceptRequiredOnlyButton: {\n        text: string,\n        show: boolean,\n    },\n    rejectAllButton: {\n        text: string,\n        show: boolean,\n    },\n}\n","import { CookiesManager } from './CookiesManager';\nexport class Modal {\n\n    private options: ModalOptions;\n    private cookiesManager: CookiesManager;\n\n    constructor(cookiesManager: CookiesManager, options: ModalOptions) {\n        this.cookiesManager = cookiesManager;\n        this.options = options;\n        this.injectModal();\n        this.setEventListeners();\n    }\n\n\n    show() {\n        const modalContainer = document.getElementById(\"modal-container\");\n        modalContainer!.classList.add('show-modal');\n        // Hide body scroll\n        document.querySelector(\"body\")!.style.overflow = \"hidden\";\n    }\n    hide() {\n        const modalContainer = document.getElementById('modal-container')\n        modalContainer!.classList.remove('show-modal')\n\n    }\n\n    setEventListeners() {\n\n        var self = this;\n        // Close modal\n        const closeBtn = document.querySelectorAll('.close-modal')\n        closeBtn.forEach(c => c.addEventListener('click', this.hide))\n\n        // Accept all btn\n        // Estos listeners deberían settearse en CookiesManager probablemente, porque va a haber que llamar métodos de ahí. O eso o Modal debería tener la instancia de CookiesManager.\n        const acceptAllBtn = document.querySelectorAll('.modal__button-accept-all')\n\n        acceptAllBtn.forEach(function (item) {\n            item.addEventListener('click', function () {\n                self.cookiesManager.acceptAllButton();\n            });\n        });\n\n        // Save button\n        const saveButton = document.querySelectorAll('.modal__button-save-btn')\n\n        saveButton.forEach(function (item) {\n            item.addEventListener('click', function () {\n               self.cookiesManager.injectScripts();\n                self.cookiesManager.hideBanner();\n                self.cookiesManager.saveButton();\n            });\n        });\n\n        // Switches\n        this.cookiesManager.getOptions().cookieCategories.forEach((category, index) => {\n\n            var checkbox = document.querySelector(`.cm-switch-${index}`)!;\n            checkbox.addEventListener('change', function () {\n                if (this.checked) {\n                    category.checked = true;\n                } else {\n                    category.checked = false;\n                }\n            });\n\n        });\n\n\n    }\n\n    public injectModal() {\n        if (document.querySelector(\"body\") != null) {\n            document.querySelector(\"body\")!.insertAdjacentHTML(\"afterend\", this.generateModal());\n        }\n    }\n\n    private generateCategoriesBlocks() {\n        let categoriesBlocks = \"\";\n        this.cookiesManager.getOptions().cookieCategories.forEach((element, index) => {\n            const disabled = element.required ? \"disabled\" : \"\";\n            const checked = element.required ? \"checked\" : \"\";\n            const block = `\n            <div class=\"cookie-category\">\n                <div class=\"cookie-category__header header\">\n                    <h2 class=\"header__title\">\n                    ${element.title}\n                    </h2>\n                    <div class=\"header__switch\">\n                    <label class=\"switch ${disabled}\">\n                        <input ${disabled} checked class=\"cm-switch-${index}\" type=\"checkbox\">\n                        <span class=\"slider round\"></span>\n                    </label>\n                    </div>\n                </div>\n            <div class=\"cookie-category__body body\">\n                <p>${element.description}</p>\n            </div>\n            </div>\n            `\n            categoriesBlocks += block;\n        });\n        return categoriesBlocks;\n\n    }\n\n    generateModal() {\n        return `\n        <div class=\"c-cookies-config-modal\">\n        <div class=\"modal__container\" id=\"modal-container\">\n          <div class=\"modal__content\">\n            <div class=\"modal__close close-modal\" title=\"Close\">\n              <svg class=\"close-modal-img\" enable-background=\"new 0 0 26 26\" version=\"1.1\" viewBox=\"0 0 26 26\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path d=\"M21.125,0H4.875C2.182,0,0,2.182,0,4.875v16.25C0,23.818,2.182,26,4.875,26h16.25   C23.818,26,26,23.818,26,21.125V4.875C26,2.182,23.818,0,21.125,0z M18.78,17.394l-1.388,1.387c-0.254,0.255-0.67,0.255-0.924,0   L13,15.313L9.533,18.78c-0.255,0.255-0.67,0.255-0.925-0.002L7.22,17.394c-0.253-0.256-0.253-0.669,0-0.926l3.468-3.467   L7.221,9.534c-0.254-0.256-0.254-0.672,0-0.925l1.388-1.388c0.255-0.257,0.671-0.257,0.925,0L13,10.689l3.468-3.468   c0.255-0.257,0.671-0.257,0.924,0l1.388,1.386c0.254,0.255,0.254,0.671,0.001,0.927l-3.468,3.467l3.468,3.467   C19.033,16.725,19.033,17.138,18.78,17.394z\" fill=\"#030104\"/>\n              </svg>\n            </div>\n        \n            <h1 class=\"modal__title\">Configuración de cookies</h1>\n            <p class=\"modal__description\">Configura aquí tus cookies.</p>\n            <div class=\"modal__cookie-categories\">\n                ${this.generateCategoriesBlocks()}\n            </div>\n    \n            <div class=\"modal__footer\">\n              <button class=\"modal__button modal__button-width modal__button-accept-all\">\n                Aceptar todas\n              </button>\n    \n              <button class=\"modal__button-link close-modal modal__button-save-btn\">\n                Guardar\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n        `;\n    }\n\n}\n\nexport interface ModalOptions {\n    acceptAllButton: {\n        text: string,\n        show: boolean,\n    },\n    saveButton: {\n        text: string,\n        show: boolean,\n    },\n    closeButton: {\n        text: string,\n        show: boolean,\n    },\n}"],"names":["Utils","ScriptType","encode","str","window","btoa","decode","a","atob","isHTML","RegExp","prototype","test","bind","match","wrapString","tag","deepEqual","x","y","_this","this","ok","Object","keys","tx","length","every","key","compareObjects","b","s","o","entries","sort","map","i","JSON","stringify","objectEquals","obj1","obj2","JSONstringifyOrder","obj","value","prepareObjectsForComparison","A","parse","B","forEach","element","checked","mergeRecursively","p","constructor","e","Banner","cookiesManager","options","banner","injectBanner","setEventListeners","_proto","self","document","querySelector","addEventListener","acceptAllButton","showModal","generateBanner","getBannerText","getAcceptAllButtonText","undefined","bannerText","text","insertAdjacentHTML","showWall","wall","wallBlur","hideWall","style","display","hideScroll","overflow","showScroll","show","wallScroll","classList","add","hide","Modal","injectModal","getElementById","remove","querySelectorAll","c","item","injectScripts","hideBanner","saveButton","getOptions","cookieCategories","category","index","generateModal","generateCategoriesBlocks","categoriesBlocks","required","title","disabled","description","CookiesManager","modalOptions","modal","acceptAll","configChanged","Error","getDefaults","localStorage","getItem","optionsComparison","getCookiesOptions","createModal","bannerOptions","createBanner","getBanner","setBanner","getModal","setModal","saveCookieOptions","showBanner","hideModal","injectScript","src","async","createElement","setAttribute","body","appendChild","injectGTM","gtmCode","w","d","l","push","Date","getTime","event","f","getElementsByTagName","j","parentNode","insertBefore","dataLayer","error","console","log","init","askOnce","askOnChange","scripts","script","type","STANDARD","scriptSrc","base64Options","setItem","closeButton","settingsButton","acceptRequiredOnlyButton","rejectAllButton"],"mappings":"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"}