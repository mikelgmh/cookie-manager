{"version":3,"file":"index.umd.js","sources":["../src/utils.ts","../src/Banner.ts","../src/Modal.ts","../src/CookiesManager.ts"],"sourcesContent":["\nexport class Utils {\n    public static encode(str) {\n        return window.btoa(str);\n    }\n    public static decode(a) {\n        return window.atob(a);\n    }\n    private static isHTML(str: string) {\n        var isHTML = RegExp.prototype.test.bind(/(<([^>]+)>)/i);\n\n        // test isHTML regex\n        return str.match(isHTML);\n\n    }\n    public static wrapString(str: string, tag: string) {\n        if (this.isHTML(str)) {\n            return str;\n        }\n        return `<${tag}>${str}</${tag}>`;\n    }\n\n    public static deepEqual(x, y) {\n        const ok = Object.keys, tx = typeof x, ty = typeof y;\n        return x && y && tx === 'object' && tx === ty ? (\n            ok(x).length === ok(y).length &&\n            ok(x).every(key => this.deepEqual(x[key], y[key]))\n        ) : (x === y);\n    }\n\n    public static compareObjects(a, b) {\n        let s = (o) => Object.entries(o).sort().map(i => {\n            if (i[1] instanceof Object) i[1] = s(i[1]);\n            return i\n        })\n        return JSON.stringify(s(a)) === JSON.stringify(s(b))\n    }\n\n    public static objectEquals(obj1, obj2) {\n        const JSONstringifyOrder = obj => {\n            const keys = {};\n            JSON.stringify(obj, (key, value) => {\n                keys[key] = null;\n                return value;\n            });\n            return JSON.stringify(obj, Object.keys(keys).sort());\n        };\n        return JSONstringifyOrder(obj1) === JSONstringifyOrder(obj2);\n    }\n\n    // @audit this is removing te callback functions. Watch out!\n    public static prepareObjectsForComparison(obj1, obj2) {\n        var A = JSON.parse(JSON.stringify(obj1));\n        var B = JSON.parse(JSON.stringify(obj2));\n\n\n        A.forEach(element => {\n            element.checked = true;\n        });\n        B.forEach(element => {\n            element.checked = true;\n        });\n        return { A, B }\n    }\n\n    public static mergeRecursively(obj1, obj2) {\n        for (var p in obj2) {\n            try {\n                // Property in destination object set; update its value.\n                if (obj2[p].constructor == Object) {\n                    obj1[p] = this.mergeRecursively(obj1[p], obj2[p]);\n                } else {\n                    obj1[p] = obj2[p];\n                }\n            } catch (e) {\n                // Property in destination object not set; create it and set its value.\n                obj1[p] = obj2[p];\n            }\n        }\n        return obj1;\n    }\n}","import { Modal } from \"./Modal\";\nimport { Utils } from './utils';\nimport { CookiesManager } from './CookiesManager';\n\nexport class Banner {\n    private options: BannerOptions;\n    private banner: string;\n    private cookiesManager: CookiesManager;\n\n    constructor(cookiesManager: CookiesManager, options: BannerOptions) {\n        this.cookiesManager = cookiesManager;\n        this.options = options;\n        if (cookiesManager.getOptions().bannerOptions.inject) {\n            this.injectBanner();\n        }\n        if (cookiesManager.getOptions().bannerOptions.injectWall) {\n            this.injectWall();\n        }\n        this.setEventListeners();\n    }\n\n    public setEventListeners() {\n        try {\n            let self = this;\n            // Accept all button\n            document.querySelector(\".cm-banner-accept-all-btn\")!.addEventListener(\"click\", function () {\n                self.cookiesManager.acceptAllButton();\n            });\n\n            // Reject all button\n            document.querySelector(\".cm-banner-reject-all-btn\")!.addEventListener(\"click\", function () {\n                self.cookiesManager.acceptAllButton(false);\n            });\n\n            // Config button\n            document.querySelector(\".cm-banner-config-btn\")!.addEventListener(\"click\", function () {\n                self.cookiesManager.showModal();\n            });\n        } catch (error) {\n            console.error(\"Can't set the event listener for the cookies banner. Can't find the HTML elements.\")\n        }\n\n    }\n\n\n\n\n    private generateBanner() {\n        return `\n                <div class=\"c-cookies-config-banner\">\n                    <div class=\"banner-container\">\n                        ${this.getBannerText()}\n                        <div class=\"banner-container__buttons\">\n                            ${this.getRejectAllButton()}\n                            ${this.getAcceptAllButton()}\n                            ${this.getSettingsButton()}\n                        </div>\n                    </div>\n                </div> \n                `;\n    }\n\n    getAcceptAllButton() {\n        return this.options.acceptAllButton.show ? `<button class=\"banner-container__button banner-container__accept-all-btn cm-banner-accept-all-btn\">${this.options.acceptAllButton.text}</button>` : \"\";\n    }\n    getRejectAllButton() {\n        return this.options.rejectAllButton.show ? `<button class=\"banner-container__button banner-container__reject-all-btn cm-banner-reject-all-btn\">${this.options.rejectAllButton.text}</button>` : \"\";\n    }\n    getSettingsButton() {\n        return this.options.settingsButton.show ? `<button class=\"banner-container__button-link banner-container__config-btn cm-banner-config-btn\">${this.options.settingsButton.text}</button>` : \"\";\n    }\n\n    private getBannerText() {\n        return Utils.wrapString(this.options.bannerText, \"p\");\n    }\n\n    private injectWall() {\n        try {\n            if (document.querySelector(\"body\") != null) {\n                document.querySelector(\"body\")!.insertAdjacentHTML(\"afterend\", this.generateWall());\n            }\n        } catch (error) {\n            console.error(\"Couldn't inject the wall.\");\n        }\n    }\n\n    public injectBanner() {\n        try {\n            if (document.querySelector(\"body\") != null) {\n                document.querySelector(\"body\")!.insertAdjacentHTML(\"afterend\", this.generateBanner());\n            }\n        } catch (error) {\n            console.error(\"Couldn't inject the banner.\");\n        }\n    }\n\n    private generateWall() {\n        const blur = this.options.wallBlur ? \"c-cookies-config-wall--blurred\" : \"\";\n        return `<div class=\"c-cookies-config-wall ${blur}\"></div>`;\n    }\n\n    public showWall() {\n        try {\n            document.querySelector<HTMLElement>(\".c-cookies-config-wall\")!.classList.add(\"wall-show\");\n        } catch (error) {\n            console.error(\"Couldn't apply the background wall.\")\n        }\n    }\n\n    public hideWall() {\n        try {\n            document.querySelector<HTMLElement>(\".c-cookies-config-wall\")!.classList.remove(\"wall-show\");\n        } catch (error) {\n            console.error(\"Unable to hide the background wall.\")\n        }\n    }\n\n    public hideScroll() {\n        try {\n            document.querySelector(\"body\")!.style.overflow = \"hidden\";\n            document.querySelector(\"html\")!.style.overflow = \"hidden\";\n        } catch (error) {\n            console.error(\"Unable to hide the scroll.\")\n        }\n    }\n\n    public showScroll() {\n        try {\n            document.querySelector(\"body\")!.style.overflow = \"auto\";\n            document.querySelector(\"html\")!.style.overflow = \"auto\";\n        } catch (error) {\n            console.error(\"Unable to show the scroll.\")\n        }\n    }\n\n    public show() {\n        if (this.options.wall) {\n            this.showWall();\n        }\n        if (!this.options.wallScroll) {\n            this.hideScroll();\n        }\n        try {\n            document.querySelector<HTMLElement>(\".c-cookies-config-banner .banner-container\")!.classList.add(\"show-banner\");\n        } catch (error) {\n            console.error(\"Unable to show the banner.\")\n        }\n    }\n    public hide() {\n        try {\n            document.querySelector<HTMLElement>(\".c-cookies-config-banner\")!.style.display = \"none\";\n        } catch (error) {\n            console.error(\"Unable to hide the banner.\")\n        }\n        this.hideWall();\n        this.showScroll();\n    }\n\n}\n\n\n\n\nexport interface BannerOptions {\n    bannerText: string;\n    wall: boolean,\n    injectWall: boolean,\n    wallScroll: boolean,\n    wallBlur: boolean,\n    inject: boolean,\n    acceptAllButton: {\n        text: string,\n        show: boolean,\n    },\n    settingsButton: {\n        text: string,\n        show: boolean,\n    },\n    acceptRequiredOnlyButton: {\n        text: string,\n        show: boolean,\n    },\n    rejectAllButton: {\n        text: string,\n        show: boolean,\n    },\n}\n","import { CookieCategory, CookiesManager } from './CookiesManager';\nexport class Modal {\n\n    private options: ModalOptions;\n    private cookiesManager: CookiesManager;\n\n    constructor(cookiesManager: CookiesManager, options: ModalOptions) {\n        this.cookiesManager = cookiesManager;\n        this.options = options;\n        if (cookiesManager.getOptions().modalOptions.inject) {\n            this.injectModal();\n        }\n        this.setEventListeners();\n        this.updateSwitchesStatus();\n    }\n\n\n    async show() {\n        try {\n\n            const modal = document.querySelector(\".c-cookies-config-modal\");\n            modal!.classList.add(this.options.showModalClass);\n            await new Promise(r => setTimeout(r, 10)); // This is to make the show animation work\n            // Toggle accordions after showing modal\n            var acc = document.getElementsByClassName(\"cm-accordion\");\n            var i;\n            var self = this;\n            for (i = 0; i < acc.length; i++) {\n                if (acc[i].classList.contains(\"cm-active-on-load\")) {\n                    acc[i].classList.remove(\"cm-active-on-load\");\n                    await new Promise(r => setTimeout(r, 100)); // This is to make the show animation work\n                    self.toggleAccordion(acc[i]);\n                }\n\n            }\n\n            const modalContainer = document.getElementById(\"modal-container\");\n            modalContainer!.classList.add(this.options.showModalClass);\n            // Hide body scroll\n            this.cookiesManager.getBanner().hideScroll();\n        } catch (error) {\n            console.error(\"Could not show cookie modal.\")\n            console.error(error)\n        }\n    }\n    hide(self?: Modal) { // Destucted object, so we can access this context\n        const modalContainer = document.getElementById('modal-container');\n        modalContainer!.classList.remove(this.options.showModalClass);\n\n        // If banner is not shown, show scroll\n        const bannerContainer = document.querySelector(\".c-cookies-config-banner .banner-container\");\n        if (bannerContainer?.classList.contains(\"show-banner\") == false) {\n            this.cookiesManager.getBanner().showScroll();\n        } else {\n            // If the banner is shown, check if the scroll was active. If it was, show the scroll on modal close.\n            const wallScroll = this.cookiesManager.getOptions().bannerOptions.wallScroll;\n            if (wallScroll) {\n                this.cookiesManager.getBanner().showScroll();\n            }\n        }\n\n    }\n\n    setEventListeners() {\n\n        try {\n            var self = this;\n            // Modal close button\n            const closeBtn = document.querySelectorAll('.close-modal')\n            closeBtn.forEach(c => c.addEventListener('click', () => {\n                this.hide(self);\n            }))\n\n            // Accept all button\n            document.querySelector('.cm-modal-accept-all')!.addEventListener('click', function () {\n                self.cookiesManager.acceptAllButton();\n            });\n\n            // Reject all button\n            document.querySelector('.cm-modal-reject-all')!.addEventListener('click', function () {\n                self.cookiesManager.acceptAllButton(false);\n            });\n\n            // Save button\n            document.querySelector('.cm-modal-save')!.addEventListener('click', function () {\n                self.cookiesManager.injectScripts();\n                self.cookiesManager.hideBanner();\n                self.cookiesManager.saveButton();\n                self.cookiesManager.callIndividualCallbacks();\n            });\n\n            // Switches\n            this.cookiesManager.getOptions().cookieCategories.forEach((category: CookieCategory, index) => {\n                var checkbox = document.querySelector(`.cm-switch-${index}`)!;\n                const cookieCategoryElements = document.querySelectorAll(\".c-cookies-config-modal .cookie-category\");\n                checkbox.addEventListener('change', function () {\n                    if (this.checked) {\n                        category.checked = true;\n                        self.toggleSwitch(index, true);\n                    } else {\n                        category.checked = false;\n                        self.toggleSwitch(index, false);\n                    }\n                });\n            });\n\n            // Set accordion toggle on click\n            var acc = document.getElementsByClassName(\"cm-accordion\");\n            var i;\n            var self = this;\n            for (i = 0; i < acc.length; i++) {\n                acc[i].addEventListener(\"click\", function () {\n                    self.toggleAccordion(this);\n                });\n            }\n\n\n        } catch (error) {\n            console.error(\"Could not set event listeners for cookie modal.\")\n        }\n    }\n\n    private updateSwitchDisabledStatus(toggleIndex: number, required: boolean) {\n        try {\n            const cookieCategoryElements = document.querySelectorAll(\".c-cookies-config-modal .cookie-category\");\n            const checkboxInput = cookieCategoryElements[toggleIndex].querySelector<HTMLInputElement>(`.cm-switch-${toggleIndex}`)!;\n            const checkboxSpan = cookieCategoryElements[toggleIndex].querySelector<HTMLInputElement>(`.slider`)!;\n            const checkboxLabel = cookieCategoryElements[toggleIndex].querySelector<HTMLInputElement>(`label.switch`)!;\n            if (required) {\n                checkboxInput.setAttribute(\"disabled\", \"\")\n                checkboxSpan.classList.add(\"disabled\");\n                checkboxLabel.classList.add(\"disabled\");\n            } else {\n                checkboxInput.removeAttribute(\"disabled\");\n                checkboxSpan.classList.remove(\"disabled\");\n                checkboxLabel.classList.remove(\"disabled\");\n            }\n        } catch (error) {\n            console.error(`Could not change the disabled status from switch cm-switch-${toggleIndex}. Do you have equal switches and cookieCategories? If cm-switch-${toggleIndex} does not exist in your DOM, probably not.`)\n\n        }\n    }\n\n    private toggleSwitch(toggleIndex: number, checked: boolean) {\n        try {\n            const cookieCategoryElements = document.querySelectorAll(\".c-cookies-config-modal .cookie-category\");\n            const checkboxInput = cookieCategoryElements[toggleIndex].querySelector<HTMLInputElement>(`.cm-switch-${toggleIndex}`)!;\n            if (!checked) {\n                checkboxInput.removeAttribute(\"checked\");\n            } else {\n                checkboxInput.setAttribute(\"checked\", \"\")\n            }\n            checkboxInput.checked = checked;\n        } catch (error) {\n            console.error(`Could not toggle the switch cm-switch-${toggleIndex}. Do you have equal switches and cookieCategories? If cm-switch-${toggleIndex} does not exist in your DOM, probably not.`)\n        }\n    }\n\n    private async toggleAccordion(element) {\n        element.classList.toggle(\"cm-active\");\n        var panel = element.nextElementSibling;\n        if (panel.style.maxHeight) {\n            panel.style.maxHeight = null;\n        } else {\n            panel.style.maxHeight = panel.scrollHeight + \"px\";\n        }\n    }\n\n    public injectModal() {\n        try {\n            if (document.querySelector(\"body\") != null) {\n                document.querySelector(\"body\")!.insertAdjacentHTML(\"afterend\", this.generateModal());\n            }\n        } catch (error) {\n            console.error(\"Could not inject cookie modal.\");\n        }\n    }\n\n    // If we're not injecting the HTML, we need to update the HTML manually after the page is loaded.\n    public updateSwitchesStatus() {\n        //const cookieCategoryElements = document.querySelectorAll(\".c-cookies-config-modal .cookie-category\");\n        let cookieCategories = this.cookiesManager.getOptions().cookieCategories;\n        cookieCategories.forEach((cookieCategory, index) => {\n            try {\n                this.toggleSwitch(index, cookieCategory.checked)\n                this.updateSwitchDisabledStatus(index, cookieCategory.required)\n            } catch (error) {\n                console.error(\"You have more cookieCategories defined in javascript than in your HTML. Please, use the same number of cookieCategories.\")\n            }\n        });\n    }\n\n    private generateCategoriesBlocks() {\n        let categoriesBlocks = \"\";\n        let cookieCategories = this.cookiesManager.getOptions().cookieCategories;\n        if (localStorage.getItem(\"cookiesManagerOptions\") != null) {\n            cookieCategories = this.cookiesManager.getCookiesOptions();\n        }\n        cookieCategories.forEach((element, index) => {\n            const disabled = element.required ? \"disabled\" : \"\";\n            const checked = element.checked ? \"checked\" : \"\";\n            const accordionClass = element.accordion.enable ? \"cm-accordion\" : \"\";\n            const accordionPanel = element.accordion.enable ? \"cm-panel\" : \"\";\n            const activeAccordion = element.accordion.active ? \"cm-active-on-load\" : \"\";\n            const accordionChevron = element.accordion.enable ? \"<div class='cc-header__left'></div>\" : \"\";\n            const boxedHeader = element.boxedHeader ? \"cm-boxed\" : \"\";\n            const boxedBody = element.boxedBody ? \"cookie-category__body--boxed\" : \"\";\n            // const boxedHeaderMArgin = element.accordion.active ? \"\" : \"no-chevron\";\n            const block = `\n            <div class=\"cookie-category\">\n                <div class=\"cookie-category__header cc-header ${accordionClass} ${boxedHeader} ${activeAccordion}\">\n                    ${accordionChevron}\n                    <div class=\"cc-header__right\">\n                        <div class=\"header__title\">\n                            ${element.title}\n                        </div>\n                        <div class=\"header__switch\">\n                            <label class=\"switch ${disabled}\">\n                                <input ${disabled} ${checked} class=\"cm-switch-${index}\" type=\"checkbox\">\n                                <span class=\"slider round ${disabled}\"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"cookie-category__body body ${boxedBody} ${accordionPanel}\">\n                    <p>${element.description}</p>\n                </div>\n            </div>\n            `;\n            categoriesBlocks += block;\n        });\n        return categoriesBlocks;\n\n    }\n\n    getCloseButton() {\n        return this.options.closeButton.show ? `<div class=\"modal__close close-modal\" title=\"Close\"><div class=\"close-modal-img\"></div></div>` : \"\";\n    }\n    getAcceptAllButton() {\n        return this.options.acceptAllButton.show ? `<button class=\"modal__button modal__button-width cm-modal-accept-all footer__button-accept-all\">${this.options.acceptAllButton.text}</button>` : \"\";\n    }\n    getRejectAllButton() {\n        return this.options.rejectAllButton.show ? `<button class=\"modal__button modal__button-width cm-modal-reject-all footer__button-reject-all\">${this.options.rejectAllButton.text}</button>` : \"\";\n    }\n    getSaveButton() {\n        return this.options.saveButton.show ? ` <button class=\"modal__button-link close-modal cm-modal-save footer__button-save-btn\"> ${this.options.saveButton.text} </button>` : \"\";\n    }\n\n    generateModal() {\n        return `\n        <div class=\"c-cookies-config-modal\">\n        <div class=\"modal__container\" id=\"modal-container\">\n          <div class=\"modal__content\">\n            ${this.getCloseButton()}\n            <div class=\"modal__title\">${this.options.title}</div>\n            <p class=\"modal__description\">${this.options.description}</p>\n            <div class=\"modal__cookie-categories\">\n                ${this.generateCategoriesBlocks()}\n            </div>\n    \n            <div class=\"modal__footer\">\n            ${this.getRejectAllButton()}\n             ${this.getAcceptAllButton()}\n             ${this.getSaveButton()}\n            </div>\n          </div>\n        </div>\n      </div>\n        `;\n    }\n\n}\n\nexport interface ModalOptions {\n    inject: boolean,\n    title: string,\n    description: string,\n    showModalClass: string,\n    acceptAllButton: {\n        text: string,\n        show: boolean,\n    },\n    rejectAllButton: {\n        show: boolean,\n        text: string,\n    },\n    saveButton: {\n        text: string,\n        show: boolean,\n    },\n    closeButton: {\n        text: string,\n        show: boolean,\n    },\n}","\nimport { Banner, BannerOptions } from \"./Banner\";\nimport { ModalOptions, Modal } from './Modal';\nimport \"./scss/styles.scss\";\nimport { Utils } from './utils';\n\ninterface cookieCatergoryCallbackInterface {\n    (CookieCategory: CookieCategory): void;\n}\nexport class CookiesManager {\n\n    // var isHTML = RegExp.prototype.test.bind(/(<([^>]+)>)/i);\n    private modalOptions: Options;\n    private banner: Banner;\n    private modal: Modal;\n    private acceptAll: boolean = false;\n    private configChanged: boolean = false;\n    private onCookieCategoryChange: cookieCatergoryCallbackInterface;\n\n\n    public getBanner(): Banner {\n        return this.banner;\n    }\n\n    public setBanner(banner: Banner): void {\n        this.banner = banner;\n    }\n\n    public getModal(): Modal {\n        return this.modal;\n    }\n\n    public setModal(modal: Modal): void {\n        this.modal = modal;\n    }\n\n    public getOptions(): Options {\n        return this.modalOptions;\n    }\n\n    public on(listener, callback: cookieCatergoryCallbackInterface) {\n        if (listener == \"onCookieCategoryChange\") {\n            this.onCookieCategoryChange = callback;\n        }\n    }\n\n    constructor(options: Options) {\n        if (options == null) {\n            throw new Error(\"Options for CookiesManager cannot be null.\");\n        } else {\n            if (options.cookieCategories == null) {\n                throw new Error(\"You should provide at least one cookie category\");\n            }\n            // Set all cookie categories as checked by default. Set default value for cookie category\n            const mergedCategories = new Array<CookieCategory>;\n            options.cookieCategories.forEach(category => {\n                //category.checked = true; // Dont set checked to true. Set checked if checked was set\n                mergedCategories.push(Utils.mergeRecursively(this.getDefaultCookieCategoryOptions(), category));\n            });\n            options.cookieCategories = mergedCategories;\n            // Merge the default options with user options\n            const clonedCategories: CookieCategory[] = options.cookieCategories;\n            options = Utils.mergeRecursively(this.getDefaultOptions(), options);\n            this.modalOptions = options;\n            this.constructorInitializationFunction(options, clonedCategories);\n        }\n    }\n\n    private constructorInitializationFunction(options, clonedCategories: CookieCategory[]) {\n        if (localStorage.getItem(\"cookiesManagerOptions\") != null) { // If there's already configuration saved\n            // Prepare the options to compare them.\n            // @audit be careful, this function is comparing two strings. The callback functions are being removed, so we need to set them below.\n            var optionsComparison = Utils.prepareObjectsForComparison(this.modalOptions.cookieCategories, this.getCookiesOptions());\n            // Check if the options in localStorage and the options from the constructor are the same\n            if (Utils.objectEquals(optionsComparison.A, optionsComparison.B)) {\n                // If the options are the same, just inject the scripts\n                this.modalOptions.cookieCategories = this.getCookiesOptions();\n                // @audit-ok We need to set the categories events again, as the callback functions were removed.\n                this.modalOptions.cookieCategories.forEach((cookieCategory, index) => {\n                    cookieCategory.events = clonedCategories[index].events;\n                });\n\n            } else {\n                localStorage.removeItem(\"cookiesManagerOptions\");\n                // If the options are different, set the configChanged to true\n                // We are in the constructor. By setting this to true, it might show the banner and modal if the user has set askOnChange to true\n                this.configChanged = true;\n            }\n        }\n\n        // Generate modal\n        if (options.modalOptions != null) {\n            this.createModal(options.modalOptions);\n        }\n\n        if (options.bannerOptions != null) {\n            this.createBanner(options.bannerOptions);\n        }\n    }\n\n    public setEventListeners() {\n        this.modal.setEventListeners();\n        this.banner.setEventListeners();\n    }\n\n    public createBanner(options: BannerOptions) {\n        this.banner = new Banner(this, options);\n        return this.banner;\n    }\n    public createModal(options: ModalOptions) {\n        this.modal = new Modal(this, options);\n        return this.modal;\n    }\n\n    public setCookies(): void {\n        this.modalOptions.cookieCategories.forEach(category => {\n            category.events.setCookiesOnChange.forEach(cookie => {\n                let cookieValue;\n                if (category.checked) {\n                    cookieValue = cookie.valueOnAccept;\n                } else {\n                    cookieValue = cookie.valueOnReject;\n                }\n                this.setCookie(cookie.cookieName, cookieValue, cookie.expirationDays, \"/\");\n            })\n        });\n    }\n\n    public setCookie(cookieName: string, cookieValue: string, expDays = 400, path = '/') {\n        try {\n            document.cookie = cookieName + '=' + encodeURIComponent(cookieValue) + '; max-age=' + (3600 * (24 * expDays)) + '; path=' + path\n        } catch (error) {\n            console.log(`Error setting cookie: ${error}`)\n        }\n    }\n\n\n\n    public acceptAllButton(acceptedAll = true) {\n        this.getOptions().cookieCategories.forEach((cookieCategory: CookieCategory) => {\n            if (cookieCategory.required && acceptedAll == false) {\n                cookieCategory.checked = true;\n            } else {\n                cookieCategory.checked = acceptedAll;\n            }\n        })\n        this.modal.updateSwitchesStatus();\n        this.acceptAll = true;\n        this.modal.hide();\n        this.banner.hide();\n        this.injectScripts();\n        this.saveCookieOptions();\n        this.setCookies();\n        this.callIndividualCallbacks();\n    }\n\n    public showModal() {\n        this.modal.show();\n    }\n\n    public showBanner() {\n        this.banner.show();\n    }\n\n    public hideBanner() {\n        this.banner.hide();\n    }\n\n    public hideModal() {\n        this.modal.hide();\n    }\n\n    public callIndividualCallbacks() {\n        this.modalOptions.cookieCategories.forEach(category => {\n            if (category.checked || this.acceptAll) {\n                category.events.onAccept();\n            } else if (!category.checked) {\n                category.events.onReject();\n            }\n        });\n    }\n\n    private injectScript(src: string, async = false) {\n        var s = document.createElement('script');\n        s.setAttribute('src', src);\n        s.async = async;\n        document.body.appendChild(s);\n    }\n\n    private injectGTM(gtmCode: string) {\n        try {\n            (function (w, d, s, l, i) {\n                w[l] = w[l] || [];\n                w[l].push({\n                    'gtm.start': new Date().getTime(),\n                    event: 'gtm.js',\n                });\n                const f = d.getElementsByTagName(s)[0];\n                const j = d.createElement(s) as HTMLInputElement;\n                const\n                    dl = l != 'dataLayer' ? `&l=${l}` : '';\n                //j.async = true;\n                j.src = `https://www.googletagmanager.com/gtm.js?id=${i}${dl}`;\n                f.parentNode!.insertBefore(j, f);\n            }(window, document, 'script', 'dataLayer', gtmCode));\n            (window as any).dataLayer = (window as any).dataLayer || [];\n        } catch (error) {\n            console.error(\"Couldn't inject GTM.\")\n        }\n    }\n\n    public async init(banner: boolean, modal: boolean) {\n        if (this.modalOptions.askOnce) {\n            if (localStorage.getItem(\"cookiesManagerOptions\") == null || this.configChanged) {\n                await this.initShow(banner, modal)\n            } // There's no else, as if cookiesManagerOptions was not null, the constructor would do the job.\n        } else {\n            await this.initShow(banner, modal)\n        }\n        if (localStorage.getItem(\"cookiesManagerOptions\") != null) {\n            this.injectScripts();\n            this.callIndividualCallbacks();\n        }\n    }\n\n    public async initShow(banner: boolean, modal: boolean) {\n        if (this.modalOptions.delay > 0) {\n            await new Promise(r => setTimeout(r, this.modalOptions.delay)); // This is to make the show animation work\n        }\n        if (banner) {\n            this.showBanner();\n        }\n        if (modal) {\n            this.showModal();\n        }\n    }\n\n    public injectScripts() {\n        try {\n\n            this.modalOptions.cookieCategories.forEach(category => {\n                if (this.onCookieCategoryChange != null) {\n                    this.onCookieCategoryChange(category);\n                }\n                if (category.checked || this.acceptAll) {\n                    category.scripts.forEach(script => {\n                        if (script[\"type\"] == ScriptType.STANDARD || script[\"type\"] == null) {\n                            if (script[\"scriptSrc\"] != null) {\n                                this.injectScript(script[\"scriptSrc\"], script[\"async\"])\n                            }\n                        } else {\n                            if (script[\"gtmCode\"] != null) {\n                                this.injectGTM(script[\"gtmCode\"]);\n                            } else {\n                                throw new Error(\"You should provide a gtmCode for the script\");\n                            }\n                        }\n                    });\n                }\n            });\n        } catch (error) {\n            console.error(`Couldn't inject scripts: ${error}`)\n        }\n    }\n\n    saveButton() {\n        this.saveCookieOptions();\n        this.setCookies();\n        this.callIndividualCallbacks();\n    }\n\n    saveCookieOptions() {\n        const base64Options = Utils.encode(JSON.stringify(this.modalOptions.cookieCategories));\n        localStorage.setItem(\"cookiesManagerOptions\", base64Options);\n    }\n\n    getCookiesOptions(): any {\n        if (localStorage.getItem(\"cookiesManagerOptions\") != null) {\n            return JSON.parse(Utils.decode(localStorage.getItem(\"cookiesManagerOptions\")));\n        }\n        return {};\n    }\n\n    private getDefaultCookieCategoryOptions(): CookieCategory {\n        return {\n            title: \"Cookie Category Example\",\n            description: \"Cookie category description\",\n            required: false,\n            id: \"\",\n            checked: true,\n            events: {\n                onAccept: () => { },\n                onReject: () => { },\n                setCookiesOnChange: []\n            },\n            accordion: {\n                enable: false,\n                enableOnDescriptionLength: 45,\n                active: false,\n            },\n            boxedHeader: false,\n            boxedBody: false,\n            scripts: []\n        }\n    }\n\n    private getDefaultOptions(): Options {\n        return {\n            askOnce: true,\n            askAgainIfRejectedAfterDays: 30,\n            delay: 0,\n            askOnChange: true,\n            initOnDomContentLoaded: true,\n            modalOptions: {\n                title: \"Cookie settings\",\n                description: \"Change the settings for the cookies here.\",\n                inject: true,\n                showModalClass: \"show-modal\",\n                acceptAllButton: {\n                    text: 'Accept all',\n                    show: true,\n                },\n                rejectAllButton: {\n                    text: 'Reject all',\n                    show: true,\n                },\n                saveButton: {\n                    text: 'Save',\n                    show: true,\n                },\n                closeButton: {\n                    text: 'Close',\n                    show: true,\n                },\n            },\n            bannerOptions: {\n                inject: true,\n                injectWall: true,\n                wall: true,\n                wallScroll: true,\n                wallBlur: false,\n                bannerText: 'This website uses cookies to ensure you get the best experience on our website.',\n                acceptAllButton: {\n                    text: 'Accept all',\n                    show: true,\n                },\n                settingsButton: {\n                    text: 'Settings',\n                    show: true,\n                },\n                acceptRequiredOnlyButton: {\n                    text: 'Configuración',\n                    show: false,\n                },\n                rejectAllButton: {\n                    text: 'Rechazar todo',\n                    show: true,\n                }\n            },\n            cookieCategories: [],\n        }\n    }\n\n\n\n}\nexport interface Events {\n    onAccept: Function,\n    onReject: Function,\n    setCookiesOnChange: Array<CookieObject>,\n}\n\nexport interface CookieObject {\n    cookieName: string,\n    valueOnAccept: string | number,\n    valueOnReject: string | number,\n    expirationDays: number,\n}\n\nexport interface Options {\n    cookieCategories: Array<CookieCategory>,\n    initOnDomContentLoaded: boolean,\n    askAgainIfRejectedAfterDays: number,\n    bannerOptions: BannerOptions,\n    modalOptions: ModalOptions,\n    askOnce: boolean,\n    askOnChange: boolean,\n    delay: number,\n}\n\nexport interface CookieCategory {\n    title: string,\n    id: string,\n    description: string,\n    required: boolean,\n    checked: boolean,\n    events: Events,\n    accordion: Accordion,\n    boxedHeader: boolean,\n    boxedBody: boolean,\n    scripts: [\n        {\n            type: ScriptType,\n            gtmCode: string,\n            scriptSrc: string,\n            async: boolean,\n        }\n    ] | []\n}\n\nexport interface Accordion {\n    enable: boolean,\n    enableOnDescriptionLength: number,\n    active: boolean,\n}\n\nexport enum ScriptType {\n    GTM,\n    STANDARD\n}"],"names":["Utils","encode","str","window","btoa","decode","a","atob","isHTML","RegExp","prototype","test","bind","match","wrapString","tag","this","deepEqual","x","y","_this","ok","Object","keys","tx","length","every","key","compareObjects","b","s","o","entries","sort","map","i","JSON","stringify","objectEquals","obj1","obj2","JSONstringifyOrder","obj","value","prepareObjectsForComparison","A","parse","B","forEach","element","checked","mergeRecursively","p","constructor","e","Banner","cookiesManager","options","banner","getOptions","bannerOptions","inject","injectBanner","injectWall","setEventListeners","_proto","self","document","querySelector","addEventListener","acceptAllButton","showModal","error","console","generateBanner","getBannerText","getRejectAllButton","getAcceptAllButton","getSettingsButton","show","text","rejectAllButton","settingsButton","bannerText","insertAdjacentHTML","generateWall","blur","wallBlur","showWall","classList","add","hideWall","remove","hideScroll","style","overflow","showScroll","wall","wallScroll","hide","display","pact","_Pact","_settle","state","v","then","observer","onFulfilled","onRejected","result","callback","thenable","ScriptType","Modal","modalOptions","injectModal","updateSwitchesStatus","_this2","Promise","resolve","showModalClass","r","setTimeout","_temp3","getElementById","getBanner","acc","getElementsByClassName","_temp2","_for","_temp","contains","toggleAccordion","_catch","reject","bannerContainer","_this3","querySelectorAll","c","injectScripts","hideBanner","saveButton","callIndividualCallbacks","cookieCategories","category","index","checkbox","toggleSwitch","updateSwitchDisabledStatus","toggleIndex","required","cookieCategoryElements","checkboxInput","checkboxSpan","checkboxLabel","setAttribute","removeAttribute","toggle","panel","nextElementSibling","maxHeight","scrollHeight","generateModal","_this4","cookieCategory","generateCategoriesBlocks","categoriesBlocks","localStorage","getItem","getCookiesOptions","disabled","accordionClass","accordion","enable","boxedHeader","activeAccordion","active","title","boxedBody","description","getCloseButton","closeButton","getSaveButton","CookiesManager","modal","acceptAll","configChanged","onCookieCategoryChange","Error","mergedCategories","Array","push","getDefaultCookieCategoryOptions","clonedCategories","getDefaultOptions","constructorInitializationFunction","setBanner","getModal","setModal","on","listener","optionsComparison","events","removeItem","createModal","createBanner","setCookies","setCookiesOnChange","cookie","setCookie","cookieName","valueOnAccept","valueOnReject","expirationDays","cookieValue","expDays","path","encodeURIComponent","log","acceptedAll","saveCookieOptions","showBanner","hideModal","onAccept","onReject","injectScript","src","async","createElement","body","appendChild","injectGTM","gtmCode","w","d","l","Date","getTime","event","f","getElementsByTagName","j","parentNode","insertBefore","dataLayer","init","_this5","askOnce","initShow","_temp6","_temp5","_temp4","_temp9","_this7","_temp10","delay","_this8","scripts","script","STANDARD","base64Options","setItem","id","enableOnDescriptionLength","askAgainIfRejectedAfterDays","askOnChange","initOnDomContentLoaded","acceptRequiredOnlyButton"],"mappings":"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"}