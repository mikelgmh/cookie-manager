{"code":"import { Banner } from \"./Banner\";\r\nimport { Modal } from './Modal';\r\nimport \"./scss/styles.scss\";\r\nexport class CookiesManager {\r\n    // var isHTML = RegExp.prototype.test.bind(/(<([^>]+)>)/i);\r\n    modalOptions;\r\n    banner;\r\n    modal;\r\n    acceptAll = false;\r\n    getBanner() {\r\n        return this.banner;\r\n    }\r\n    setBanner(banner) {\r\n        this.banner = banner;\r\n    }\r\n    getModal() {\r\n        return this.modal;\r\n    }\r\n    setModal(modal) {\r\n        this.modal = modal;\r\n    }\r\n    getOptions() {\r\n        return this.modalOptions;\r\n    }\r\n    constructor(options) {\r\n        if (options == null) {\r\n            throw new Error(\"Options cannot be null\");\r\n        }\r\n        else {\r\n            options.cookieCategories.forEach(category => {\r\n                category.checked = true;\r\n            });\r\n            this.modalOptions = options;\r\n            // Check options to create banner and modal\r\n            // Generate modal\r\n            if (options.modalOptions != null) {\r\n                this.createModal(options.modalOptions);\r\n            }\r\n            if (options.bannerOptions != null) {\r\n                if (options.modalOptions != null) {\r\n                    options.bannerOptions.settingsButton.modal = this.modal; // The modal was already created\r\n                }\r\n                this.createBanner(options.bannerOptions);\r\n            }\r\n        }\r\n    }\r\n    createBanner(options) {\r\n        this.banner = new Banner(this, options);\r\n        return this.banner;\r\n    }\r\n    createModal(options) {\r\n        this.modal = new Modal(this, options);\r\n        return this.modal;\r\n    }\r\n    acceptAllButton() {\r\n        this.acceptAll = true;\r\n        this.modal.hide();\r\n        this.banner.hide();\r\n        this.injectScripts();\r\n        this.setCookie();\r\n    }\r\n    showModal() {\r\n        this.modal.show();\r\n    }\r\n    showBanner() {\r\n        this.banner.show();\r\n    }\r\n    hideBanner() {\r\n        this.banner.hide();\r\n    }\r\n    hideModal() {\r\n        this.modal.hide();\r\n    }\r\n    injectScript(src, async) {\r\n        var s = document.createElement('script');\r\n        s.setAttribute('src', src);\r\n        s.async = async;\r\n        document.body.appendChild(s);\r\n    }\r\n    init(banner, modal) {\r\n        if (this.modalOptions.askOnce) {\r\n            if (this.readCookie() != \"true\") {\r\n                if (banner) {\r\n                    this.showBanner();\r\n                }\r\n                if (modal) {\r\n                    this.showModal();\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (banner) {\r\n                this.showBanner();\r\n            }\r\n            if (modal) {\r\n                this.showModal();\r\n            }\r\n        }\r\n    }\r\n    injectScripts() {\r\n        this.modalOptions.cookieCategories.forEach(category => {\r\n            if (category.checked || this.acceptAll) {\r\n                category.scripts.forEach(script => {\r\n                    console.log(\"injecting script: \" + script.scriptSrc);\r\n                    this.injectScript(script.scriptSrc, script.async);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    saveButton() {\r\n        this.setCookie();\r\n    }\r\n    setCookie(name = \"analyticsCookie\", value = true, days = 365) {\r\n        let expires;\r\n        if (days) {\r\n            const date = new Date();\r\n            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\r\n            expires = `; expires=${date.toUTCString()}`;\r\n        }\r\n        else {\r\n            expires = '';\r\n        }\r\n        document.cookie = `${encodeURIComponent(name)}=${encodeURIComponent(value)}${expires}; path=/`;\r\n    }\r\n    readCookie(name = \"analyticsCookie\") {\r\n        const nameEQ = `${encodeURIComponent(name)}=`;\r\n        const ca = document.cookie.split(';');\r\n        for (let i = 0; i < ca.length; i++) {\r\n            let c = ca[i];\r\n            while (c.charAt(0) === ' ')\r\n                c = c.substring(1, c.length);\r\n            if (c.indexOf(nameEQ) === 0)\r\n                return decodeURIComponent(c.substring(nameEQ.length, c.length));\r\n        }\r\n        return null;\r\n        // if (readCookie(\"analyticCookie\") === \"true\") {\r\n        //     launchAnalytics();\r\n        // }\r\n    }\r\n}\r\nexport var ScriptType;\r\n(function (ScriptType) {\r\n    ScriptType[ScriptType[\"GTM\"] = 0] = \"GTM\";\r\n    ScriptType[ScriptType[\"STANDARD\"] = 1] = \"STANDARD\";\r\n})(ScriptType || (ScriptType = {}));\r\n//# sourceMappingURL=CookiesManager.js.map","references":["/home/mikel/Projects/cookies-banner-micro/src/Banner.ts","/home/mikel/Projects/cookies-banner-micro/src/Modal.ts"],"map":"{\"version\":3,\"file\":\"CookiesManager.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/CookiesManager.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/mikel/Projects/cookies-banner-micro/dist/CookiesManager.d.ts","writeByteOrderMark":false,"text":"import { Banner, BannerOptions } from \"./Banner\";\r\nimport { ModalOptions, Modal } from './Modal';\r\nimport \"./scss/styles.scss\";\r\nexport declare class CookiesManager {\r\n    private modalOptions;\r\n    private banner;\r\n    private modal;\r\n    private acceptAll;\r\n    getBanner(): Banner;\r\n    setBanner(banner: Banner): void;\r\n    getModal(): Modal;\r\n    setModal(modal: Modal): void;\r\n    getOptions(): Options;\r\n    constructor(options: Options);\r\n    createBanner(options: BannerOptions): Banner;\r\n    createModal(options: ModalOptions): Modal;\r\n    acceptAllButton(): void;\r\n    showModal(): void;\r\n    showBanner(): void;\r\n    hideBanner(): void;\r\n    hideModal(): void;\r\n    private injectScript;\r\n    init(banner: boolean, modal: boolean): void;\r\n    injectScripts(): void;\r\n    saveButton(): void;\r\n    setCookie(name?: string, value?: boolean, days?: number): void;\r\n    readCookie(name?: string): string;\r\n}\r\nexport interface Options {\r\n    cookieCategories: [\r\n        {\r\n            title: string;\r\n            description: string;\r\n            required: boolean;\r\n            checked: boolean;\r\n            scripts: [\r\n                {\r\n                    type: ScriptType;\r\n                    gtmCode: string;\r\n                    scriptSrc: string;\r\n                    async: boolean;\r\n                }\r\n            ];\r\n        }\r\n    ];\r\n    bannerOptions: BannerOptions;\r\n    modalOptions: ModalOptions;\r\n    askOnce: boolean;\r\n}\r\nexport declare enum ScriptType {\r\n    GTM = 0,\r\n    STANDARD = 1\r\n}\r\n"}}
